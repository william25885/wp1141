# Image Map Message（圖片地圖訊息）設定指南

Image Map Message 是 LINE Bot 的一種互動訊息類型，可以在圖片上設定可點擊的區域，讓使用者點擊圖片上的不同區域來觸發不同的功能。

## 優點

- ✅ 不需要在 LINE 官方帳號管理後台設定
- ✅ 可以直接在訊息中發送，使用者隨時可以看到
- ✅ 視覺效果更好，可以自訂圖片設計
- ✅ 設定簡單，只需要準備一張圖片

## 步驟 1: 準備功能選單圖片

### 圖片規格

- **建議尺寸**：1040x1040px（正方形）
- **格式**：PNG 或 JPEG
- **檔案大小**：小於 1MB
- **設計建議**：將圖片分成 2x2 的網格，每個區域對應一個功能

### 圖片設計範例

```
┌─────────────┬─────────────┐
│             │             │
│  旅遊推薦   │  查詢偏好   │
│             │             │
├─────────────┼─────────────┤
│             │             │
│ 查看上次行程│  修改偏好   │
│             │             │
└─────────────┴─────────────┘
```

### 可點擊區域對應

| 區域 | 座標範圍 | 功能 |
|------|---------|------|
| 左上 | (0, 0) - (520, 520) | 旅遊推薦 |
| 右上 | (520, 0) - (1040, 520) | 查詢偏好 |
| 左下 | (0, 520) - (520, 1040) | 查看上次行程 |
| 右下 | (520, 520) - (1040, 1040) | 修改偏好 |

## 步驟 2: 上傳圖片

### 方式一：使用 Vercel Public 資料夾（推薦）

1. 將圖片放在 `public/images/` 資料夾
2. 命名為 `feature-menu.png` 或 `feature-menu.jpg`
3. 部署後，圖片 URL 會是：`https://your-domain.vercel.app/images/feature-menu.png`

### 方式二：使用外部圖片服務

可以使用以下服務上傳圖片：
- [Imgur](https://imgur.com/)
- [Cloudinary](https://cloudinary.com/)
- [GitHub](https://github.com/) (放在 repository 中)
- 其他圖片託管服務

## 步驟 3: 設定環境變數（可選）

如果圖片不在預設位置，可以在 Vercel 環境變數中設定：

```bash
FEATURE_MENU_IMAGE_URL=https://your-image-url.com/feature-menu.png
```

如果不設定，系統會使用預設的 placeholder 圖片。

## 步驟 4: 測試

1. 加入 Bot 為好友，應該會看到歡迎訊息和功能選單圖片
2. 點擊圖片上的不同區域，測試每個功能是否正常運作
3. 輸入「功能」指令，應該也會顯示功能選單圖片

## 功能按鈕對應

Image Map Message 中的可點擊區域會發送以下訊息，Bot 會自動處理：

| 區域 | 發送訊息 | 功能說明 |
|------|---------|---------|
| 左上 | `旅遊推薦` | 開始旅遊規劃流程 |
| 右上 | `查詢偏好` | 查看已保存的旅遊偏好 |
| 左下 | `查看上次行程` | 查看最近的行程規劃記錄 |
| 右下 | `修改偏好` | 重置偏好並重新開始規劃 |

## 自訂圖片設計工具

可以使用以下工具設計功能選單圖片：

- **Canva**：https://www.canva.com/
- **Figma**：https://www.figma.com/
- **Photoshop** / **GIMP**
- **線上圖片編輯器**：https://www.photopea.com/

### 設計建議

1. **清晰的視覺分區**：使用線條或顏色區分四個功能區域
2. **圖示 + 文字**：每個區域包含圖示和功能名稱
3. **一致的風格**：保持整體設計風格一致
4. **對比度**：確保文字和圖示清晰可見

## 範例圖片設計

```
┌─────────────────────────────────┐
│  [✈️ 旅遊推薦]  [🔍 查詢偏好]  │
│                                  │
│  [📋 查看上次行程] [✏️ 修改偏好] │
└─────────────────────────────────┘
```

## 常見問題

### Q: 圖片上傳後看不到？

**A: 請檢查：**
1. 圖片 URL 是否正確
2. 圖片是否可公開存取（沒有權限限制）
3. 圖片格式和尺寸是否符合要求
4. 環境變數 `FEATURE_MENU_IMAGE_URL` 是否正確設定

### Q: 點擊圖片沒有反應？

**A: 請檢查：**
1. 點擊的區域是否在設定的座標範圍內
2. Bot 的 Webhook 是否正常運作
3. 檢查 Vercel Function Logs 查看是否有錯誤

### Q: 可以改變圖片尺寸嗎？

**A: 可以，但需要同時修改程式碼中的 `baseSize` 和 `area` 座標。**

例如，如果使用 1200x800px 的圖片：
- 修改 `baseSize: { width: 1200, height: 800 }`
- 調整每個 `area` 的座標和尺寸

### Q: 可以增加更多功能按鈕嗎？

**A: 可以，但建議最多 4 個按鈕（2x2 布局）。**

如果需要更多按鈕，可以：
- 使用 3x2 布局（6 個按鈕）
- 或使用多張 Image Map Message

## 相關文件

- [LINE Image Map Message API 文件](https://developers.line.biz/en/docs/messaging-api/using-imagemap-messages/)
- [專案 README](./README.md)

